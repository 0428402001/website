<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>ZMap · Introduction</title>
		<meta name="description" context="some description should go here"/>
		<link href="css/bootstrap.min.css" rel="stylesheet"/>
		<link href="css/bootstrap-responsive.min.css" rel="stylesheet"/>
		<link href="css/local.css" rel="stylesheet"/>
	</head>
	<body>
		<div class="navbar navbar-static-top navbar-inverse">
		  <div class="navbar-inner">
		    <a class="brand" href="index.html">ZMap · The Ultrafast Internet Scanner</a>
		    <ul class="nav pull-right">
		      <li class="active"><a href="introduction.html">Introduction</a></li>
					<li><a href="documentation.html">Documentation</a></li>
					<li><a href="download.html">Download</a></li>
		    </ul>
		  </div>
		</div>
		<div class="content">
			<div class="container">
				<div class="row-fluid">
					<div class="span12 white-panel title">
						<div class="titlecontent">
							<h2>ZMap · Introduction</h2>
						</div>
					</div>
				</div>
				<div class="row-fluid">
					<div class="span2">
						<ul class="white-nav nav nav-tabs nav-stacked">
						  <li><a href="#introduction">Introduction</a></li>
						<li><a href="#team">The Team</a></li>
							<li><a href="#architecture">Architecture</a></li>
							<li><a href="#ethics">Ethical Usage</a></li>
							
						</ul>
					</div>
					
					<div class="span10 white-panel">
						<div class="content">
							<a name="introduction"></a>
							<h3>Introduction</h3>
							<p>ZMap is a network scanner designed for performing comprehensive scans of the IPv4 address space. On a typical desktop computer and a one gigabit ethernet connection, ZMap is capable of performing a scan of the Internet in 40 minutes and with approximately 97% coverage. </p><p>While previous network tools have been designed to scan small network segments, ZMap is specifically architected to scan the entire address space, and is built in a modular manner in order to allow its incorporation with other network survey tools. ZMap operates on the GNU/Linux platform and currently supports <a href="http://en.wikipedia.org/wiki/Port_scanner#SYN_scanning">TCP SYN</a> and <a href="http://en.wikipedia.org/wiki/Ping_(networking_utility)#Echo_request">ICMP echo request</a> scanning.</p>
							<br/>
							<a name="team"></a>
							<h3>The Team</h3>
							<p>ZMap was developed and is maintained by a team of computer scientists at the <a href="https://www.cse.umich.edu">University of Michigan</a>:</p>
							<ul class="authors">
					            <li><a href="https://zakird.com">Zakir Durumeric</a>, Ph.D. Student, University of Michigan</li>
					            <li><a href="https://ericw.us/trow/">Eric Wustrow</a>, Ph.D. Student, University of Michigan</li>
					            <li><a href="https://jhalderm.com">J. Alex Halderman</a>, Assistant Professor, University of Michigan</li>
					          </ul>
					          <p>The research team can be reached at <a href="mailto:zmap-team@umich.edu">zmap-team@umich.edu</a>.</p>
							<p>We also acknowledge and thank Michael Bailey, Kevin Cheek, Aleksander Durumeric, Nadia Heninger, Paul Howell, James Kasten, Patrick Pannuto, and the University of Michigan Information and Infrastructure Assurance Team for their support and advice in developing and testing ZMap.</p>
							<br/>
							<a name="architecture"></a> 
							<h3>Architecture</h3>
							<p>While previous network scanners have been developed for scanning smaller network segments, ZMap is specifically architected for comprehensively scanning the public IPv4 address space. The scanner is composed of three major components: a modular sender, receiver, and a plugin-based framework for managing result output. ZMap is written in C and is designed for use on GNU/Linux, but is otherwise platform independent; no special drivers, hardware, or specific system configuration is necessary.</p>
							
							<p>ZMap is capable of performing such rapid scans because it maintains no local state for individual scanned hosts and bypasses most components in the Linux network stack. Further, ZMap does not perform <em>bucketing</em> or enforce strict-timeouts which ultimately lead to blocking throughout the scan. Instead, ZMap utilizes several algebraic number theory primitives that allow the sender and receiver to act independently and continuously throughout the scan and overloads otherwise unused values in each probe packet in order to perform validation. Scan speed is currently limited by the theoretical limits of 1gigE.</p>
							<p> We implement ZMap as a multi-threaded architecture in order to allow concurrent sending and receiving and increased performance by generating and sending packets on multiple cores; it is inherently designed to be run on a multi-core or multi-processor host. ZMap requires approximately 512 MB of memory for scanning which we believe is commonplace in most commodity servers at this time.</p><br/>
				              	<h4>Sending</h4>
								<p>The sending component of ZMap operates across one or more threads, each of which maintains a tight loop that sends Ethernet-level packets through a raw Linux socket. On ZMap initialization, each thread generates the skeleton of the probe packet. During iteration, ZMap updates host specific values, calculates the necessary partial checksums, and sends the packet on a RAW socket.</p><p>Sending packets at the Ethernet layer allows us to bypass inefficiencies otherwise incurred in the kernel such as route lookups, connection tracking, and allows us to update and re-checksum only the necessary parts of probe packets. This methodology ultimately allows us to scan at the rate of approximately 1.4 million packets per second on an entry level server and a 1 gigabit Internet connection.</p><p>Packets are generated using <a href="documentation.html#extension">send modules</a> which allow different types of scans (currently TCP SYN and ICMP echo request) to be supported with the same architecture. ZMap can be extended to perform other types of single-packet scans by implementing and registering a send module with ZMap.</p>
								<br/>
							<h4>Statelessness</h4>
							<p>We expect that a small percentage of hosts will respond
              with an open port (e.g. with a SYNACK packet) and we can
              greatly increase the rate at which we can send packets and
              reduce system requirements by removing the need to maintain
              state on sent packets. We scan IP addresses according
              to a randomly generated permutation in order to avoid overloading
              destination networks, triggering intrusion detection systems
              (IDS), and to provide more consistent results in the case of
              transient network failures</p>
              
              <p>In order to scan in a random order without having to
              maintain a list of what addresses have been scanned or need to be scanned, we iterate over a <a href="http://en.wikipedia.org/wiki/Multiplicative_group_of_integers_modulo_n">multiplicative group of integers modulo p</a>, choosing p to be a prime slightly
              larger than 2**32. By choosing p to be a prime, we guarantee that the
              group is cyclic, randomly distributed, and will reach all addresses in the IPv4
              address space once per scan. Using this methodology, we only need to
              maintain a minimal state of three integers: the primitive root
              used to generate the multiplicative group, the last IP address
              scanned, and the IP address initially scanned. We generate a new permutation of addresses for each
              scan invocation by generating a random primitive root of the multiplicative group and a random starting address within
              the permutation.</p>
              
              <p>While we refrain from locally
              storing state for sent packets, we perform validation
              on received response packets by encoding a secret in the
              TCP or UDP source port of the initial probe packet and checking the
              destination port or ICMP IDs on received response packets.
              This check, while inexpensive, prevents the incorrect
              reporting of spurious packets and responses from
              prior scans.</p>
			
							<br/>
							<h4>Receiving</h4>
								<p>We implement the receiver component of
								ZMap using <a href="http://www.tcpdump.org/">libpcap</a> which allows us to reduce shared state between sending
								and receiving components. On receipt of response packets on the selected device, we check source
								and destination port, discard packets not initiated by the scanner, and	perform a user-controlled callback.
								In order to handle duplicate packets, either sent spuriously by hosts or due to a dropped RST packet, we implement
								an in-memory bit-array to track hosts that have responded.</p><br/>
								
							<h4>Modular Output</h4>
							<p>We expect that the results of ZMap scans will be fed into
							other tools for additional processing such as performing a protocol handshake. In order to support this operation and
								to allow ZMap to be easily extended in order to perform additional
								analysis on the RAW packet data, we implement a modular
								interface to handle scan output.</p>
								
								<p>This modular interface allows additional outputs to be
								easily developed by writing callbacks that accept parsed
								data and are triggered by specific ZMap actions as desired:
								scan initialization, probe packet sent, new response received,
								regular progress updates, and scan termination.
								ZMap includes several modules that we believe will cover
								basic use and can be selected at runtime including a simple
								file output (file stream containing a list of unique IP addresses
								with the specified port open), extended file output (file stream
								containing a list of all packet responses and timing data),
								and a pipelined interface to the Redis in-memory key-value
								store. Additional information on developing output modules can be found <a href="documentation.html#extension">here</a>.</p>
							
							<br/>
							<a name="ethics"></a> 
							<h3>Being a Good Neighbor</h3>
							
							<p>While ZMap is a powerful tool for researchers, please keep in mind that by running ZMap, you are potentially scanning the <strong>ENTIRE</strong> Internet and some users may not appreciate your packets. Similarly, if you are scanning a smaller subnet, consider that at full-speed, you are scanning 1.4 million hosts per second and can easily cause a denial service regardless of address randomization. This means that a /16 is scanned in approximately .04 seconds.</p>
							
							<p>We encourage ZMap users to respect requests to stop scanning and to <a href="documentation.html#blacklisting">blacklist</a> these networks from ongoing scanning. Further, we encourage researchers to put up a website explaining that their scanning is non-malicious and information on how administrators can request their networks to be blacklisted.</p>
							<br/>
						</div>
					</div>
				</div>
			</div>
		</div>
	</body>
</html>